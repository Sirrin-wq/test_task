## Несоответствия в API-документации и реализации

Этот документ фиксирует расхождения между предоставленной OpenAPI-спецификацией, общепринятыми стандартами REST и фактическим поведением API.

## Ошибки и недостатки в документации (OpenAPI Spec)

Эти проблемы делают документацию внутренне противоречивой, неполной или не соответствующей стандартам.

### 1. Семантические ошибки HTTP

**Эндпоинт** `POST /api/automationTask/getOne`
*   **Проблема**: Для операции получения данных используется метод POST с кодом ответа 201 Created.
*   **Ожидание**: Операции чтения должны использовать метод GET с кодом 200 OK. Код 201 предназначен для успешного создания нового ресурса.

### 2. Логические ошибки в схемах данных

**Эндпоинт** `GET /api/automationTask/getAll`
*   **Проблема**: Схема ответа указана как одиночный объект PlayerResponseDTO.
*   **Ожидание**: Для эндпоинта, возвращающего коллекцию, схема ответа должна быть массивом объектов (type: array).

**Схема** `PlayerResponseDTO`
*   **Проблема**: Поле "currency_code" указано в массиве required, но полностью отсутствует в блоке properties.
*   **Последствие**: Спецификация становится невалидной, так как обязательное поле не имеет определения типа.

**Схема** `CredentialsLoginDTO`
*   **Проблема**: Схема объявлена в компонентах, но ни один эндпоинт её не использует.
*   **Последствие**: Наличие неиспользуемой схемы вносит путаницу и загромождает документацию.

### 3. Недостаточное описание ошибок
*   **Проблема**: Ответы с кодами 400 Bad Request, 401 Unauthorized и другими имеют только текстовое описание (description). Не определена схема тела ошибки.
*   **Последствие**: Клиентское приложение не может стандартизированно парсить и обрабатывать информацию об ошибках, например, извлекать код ошибки или сообщение для пользователя.

### 4. Избыточность и неоднозначность
*   **Эндпоинт**: `POST /api/tester/login`
*   **Проблема**: Одновременно используется механизм security: BasicAuth (логин и пароль в заголовке Authorization) И ожидается тело запроса CredentialsDTO с теми же данными.
*   **Неоднозначность**: Неясно, достаточно ли одного метода аутентификации или они оба обязательны. Стандартная практика предполагает использование одного метода.

## Несоответствия реального поведения API документации

Эти пункты описывают, чем фактический ответ API отличается от заявленного в спецификации.

### 1. `POST /api/tester/login`
*   **Ожидаемый ответ (по документации)**: Объект TokenDTO с полями access_token, token_type, expires_in, scope.
*   **Фактический ответ**: Объект, содержащий два ключа: user (объект с подробными данными пользователя) и accessToken (строка с JWT-токеном в camelCase).
*   **Вывод**: Схема TokenDTO недействительна. Фактически возвращается совершенно иной тип объекта.

### 2. `POST /api/automationTask/create`
*   **Ожидаемый ответ**: Объект PlayerResponseDTO с полями id (integer), username, email, name, surname.
*   **Фактический ответ**: Объект, похожий на запрос (PlayerRequestDTO), дополненный служебными полями базы данных. Включает технические поля MongoDB (`_id`, `__v`), а также отправленные в запросе поля currency_code, password_change, password_repeat. Идентификатор возвращается как `_id` строкового типа.
*   **Вывод**: Возвращается не чистый профиль игрока, а почти полная копия запроса с техническими полями СУБД.

### 3. `DELETE /api/automationTask/deleteOne/{id}`
*   **Ожидание (по документации)**: Параметр пути id имеет тип integer.
*   **Реальность**: Система генерирует и использует строковые идентификаторы (например, "696a6424c25add5b58643988").
*   **Критическое последствие**: Строго следуя документации, невозможно сформировать валидный запрос. Любая попытка передать integer приводит к ошибке 400 Bad Request. Параметр должен быть объявлен как string.

### 4. `GET /api/automationTask/getAll`
*   **Ожидаемый ответ (по документации)**: Один объект PlayerResponseDTO.
*   **Фактический ответ**: Массив объектов.
*   **Структура элемента в реальном ответе**: Каждый элемент массива содержит поля id (string), currency_code, username, email, name, surname. Это отличается от схемы PlayerResponseDTO, где id — integer, а currency_code отсутствует.
*   **Вывод**: Документация ошибается в фундаментальном типе возвращаемых данных (объект vs массив) и в схеме каждого элемента.

### 5. `POST /api/automationTask/getOne`
*   **Проблема семантики**: Уже описана в разделе "Ошибки документации" (использование POST/201 для GET-операции).
*   **Проблема данных**:
    *   **Ожидание**: Объект PlayerResponseDTO с полем id типа integer.
    *   **Реальность**: Объект с полем id типа string и дополнительным полем currency_code.
*   **Вывод**: Помимо семантической ошибки HTTP, схема данных в ответе также не соответствует спецификации.
